<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Federated Learning Server</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <header>
        <div class="header-container">
            <img src="{{ url_for('static', filename='cct_logo.png') }}" alt="CCT Logo" class="logo">
            <div class="title-container">
                <h1>Federated Learning Server</h1>
            </div>
        </div>
    </header>
    <div class="container">
        <div class="grid-container">
            <div class="connected-clients">
                <h2>Connected Clients</h2>
                <ul>
                    {% for client_id, info in clients.items() %}
                        <li>{{ client_id }} (Address: http://{{ info.host }}:{{ info.port }}, Status: {{ info.status }})</li>
                    {% endfor %}
                </ul>
            </div>
            <div class="training-type">
                <h2>Training Type</h2>
                <div class="buttons-container">
                    <div class="dropdown">
                        <button class="dropbtn">Select Training</button>
                        <div class="dropdown-content">
                            <a href="#" onclick="startTraining('technological')">Technological</a>
                            <a href="#" onclick="startTraining('medical')">Medical</a>
                        </div>
                    </div>
                    <button class="refresh-button" onclick="refreshServer()">
                        <i class="fas fa-sync-alt"></i> Refresh Server
                    </button>
                </div>
            </div>
        </div>

        <h2>Client Metrics</h2>
        <ul>
            {% for client_id, info in clients.items() %}
                <li>
                    <strong>{{ client_id }}</strong>: 
                    loss: {{ "%.4f"|format(info.metrics.get('loss', 0)) }} - 
                    accuracy: {{ "%.4f"|format(info.metrics.get('accuracy', 0)) }} - 
                    val_loss: {{ "%.4f"|format(info.metrics.get('val_loss', 0)) }} - 
                    val_accuracy: {{ "%.4f"|format(info.metrics.get('val_accuracy', 0)) }}
                </li>
            {% endfor %}
        </ul>

        <h2>Global Model Metrics</h2>
        <p>Number of Training Rounds: {{ num_rounds }}</p>
        <pre id="global-metrics">
            {% if metrics %}
                loss: {{ "%.4f"|format(metrics.get('loss', 0)) }} - accuracy: {{ "%.4f"|format(metrics.get('accuracy', 0)) }} - val_loss: {{ "%.4f"|format(metrics.get('val_loss', 0)) }} - val_accuracy: {{ "%.4f"|format(metrics.get('val_accuracy', 0)) }}
            {% else %}
                No global model metrics available yet.
            {% endif %}
        </pre>
    </div>
    <footer>
        <p>Developed with ❤️ by student sba23021</p>
    </footer>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
